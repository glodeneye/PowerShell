<#
This is for Microsoft Outlook vulnerability for Windows (CVE-2023-23397)
https://nvd.nist.gov/vuln/detail/CVE-2023-23397

The PowerShell commands in this script are a wrapper around the OfficeC2RClient.exe tool.
That executable accepts a variety of arguments, though I have not found a full list documented.

The script as-is uses this argument list: "/update user updatepromptuser=true"
This will open a GUI prompt on the workstation notifying the user that updates are available.
It gives them the opportunity to say 'yes' or 'no'.
If the latest updates are already installed, it will just say, "You're up to date!"

If you run the command *only* using the "/update user" argument, it's more forceful.
If there are Office apps open, it will prompt the user to close apps to continue the updates.
If there are *no* apps open, it will start installing the updates without the user's consent.

Other arguments you can use at your discretion:

displaylevel=false
	This suppresses the on-screen display from Office update

forceappshutdown=true
	This forcibly closes any open Office apps to allow the updates to complete

#>

#Check whether 64 bit office installed
$64Office = Test-Path "C:\Program Files\Common Files\microsoft shared\ClickToRun\OfficeC2RClient.exe"
Write-Output "64 Bit Office installed: $64Office"

#If 64 bit Office installed, run this command
if ($64Office) {
    
    Start-Process -FilePath "C:\Program Files\Common Files\microsoft shared\ClickToRun\OfficeC2RClient.exe" -ArgumentList "/update user updatepromptuser=true"
 
}

#Check whether 32 bit office installed
$32Office = Test-Path "C:\Program Files (x86)\Common Files\microsoft shared\ClickToRun\OfficeC2RClient.exe"
Write-Output "32 Bit Office installed: $32Office"

#If 32 bit office installed, run this command
if ($32Office) {
    
    Start-Process -FilePath "C:\Program Files (x86)\Common Files\microsoft shared\ClickToRun\OfficeC2RClient.exe" -ArgumentList "/update user updatepromptuser=true"
    
}
